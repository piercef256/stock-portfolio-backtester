(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2005:function(e,t,n){Promise.resolve().then(n.bind(n,5997))},5997:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var a=n(9268),s=n(6006),o=function(e){let{onDone:t}=e,[n,o]=(0,s.useState)(1);return(0,a.jsxs)("div",{children:[1===n&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:'Step 1: Add a stock by selecting one from the "Select a stock" dropdown, or by entering your own stock ticker into the textbox, then clicking the "Add stock" button.'}),(0,a.jsx)("button",{onClick:()=>{o(e=>e+1)},children:"Next"}),(0,a.jsx)("button",{onClick:t,children:"Done"})]}),2===n&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:'Step 2: When you have added the stocks that you want to analyze, click the "Show Graph" button, and dive into the stock data!'}),(0,a.jsx)("button",{onClick:t,children:"Done"})]})]})},r=function(e){let{onAddStock:t,onRemoveStock:n,onToggleAdvancedView:r,onFetchStockData:c,stockList:i}=e,[l,d]=(0,s.useState)(""),[h,u]=(0,s.useState)(!1),[x,j]=(0,s.useState)(!1),p=()=>{j(e=>!e)},m=e=>{n(e)};return(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:p,children:"Help"}),x&&(0,a.jsx)(o,{onDone:p}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>d(e.target.value),placeholder:"Enter stock symbol"}),(0,a.jsx)("button",{onClick:()=>{t(l),console.log(l),d("")},children:"Add stock"}),(0,a.jsx)("button",{onClick:()=>{c()},children:"Show Graph"}),(0,a.jsxs)("label",{style:{position:"relative"},children:[(0,a.jsx)("input",{type:"checkbox",onChange:()=>{r()}}),"Advanced view",(0,a.jsx)("span",{style:{marginLeft:"5px"},onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:"?"}),h&&(0,a.jsx)("div",{style:{position:"absolute",top:"100%",left:"0",backgroundColor:"#fff",border:"1px solid #ccc",padding:"5px",zIndex:1},children:"The advanced view will take up more space and may be confusing"})]}),(0,a.jsxs)("select",{value:l,onChange:e=>d(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Select a stock"}),["MSFT","AAPL","NVDA"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsx)("p",{children:"Click on a stock to remove it from the list"}),(0,a.jsx)("ul",{children:i.map(e=>(0,a.jsx)("li",{onClick:()=>m(e),children:e},e))})]})},c=n(4093),i=n(1482),l=n(1037),d=n(273),h=n(9174),u=n(1853),x=n(4824),j=n(1556),p=function(e){let{data:t}=e,n=Object.keys(t),s=Object.entries(t[n[0]]).map(e=>{let[a,s]=e,o={date:a};return n.forEach(e=>{o[e]=t[e][a]}),o}),o=j.Z;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Hover your mouse over the graph to see the price on a particular date."}),(0,a.jsxs)(c.w,{width:600,height:300,data:s,children:[(0,a.jsx)(i.K,{dataKey:"date"}),(0,a.jsx)(l.B,{}),(0,a.jsx)(d.q,{strokeDasharray:"3 3"}),(0,a.jsx)(h.u,{}),(0,a.jsx)(u.D,{}),n.map((e,t)=>(0,a.jsx)(x.x,{type:"monotone",dataKey:e,stroke:o[t%o.length],dot:!1},e))]})]})},m=function(e){let{data:t,extraStockData:n,stockRatios:s}=e;return(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Symbol"}),(0,a.jsx)("th",{children:"Calmar Ratio"}),(0,a.jsx)("th",{children:"Sharpe Ratio"}),(0,a.jsx)("th",{children:"Treynor Ratio"})]})}),(0,a.jsx)("tbody",{children:s.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.symbol}),(0,a.jsx)("td",{children:e.data.calmar_ratio.toFixed(6)}),(0,a.jsx)("td",{children:e.data.sharpe_ratio.toFixed(6)}),(0,a.jsx)("td",{children:e.data.treynor_ratio.toFixed(6)})]},e.symbol))})]})},k=n(4214),y=e=>{let{data:t}=e;return(0,a.jsx)("div",{children:Object.entries(t).map(e=>{let[t,n]=e;return(0,a.jsxs)("div",{children:[t,": ",n]},t)})})};function b(e){let{symbol:t,start:n,end:o}=e,[r,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=async()=>{let e=await k.Z.get("http://localhost:8000/stock?symbol=".concat(t,"&start=").concat(n,"&end=").concat(o));c(e.data),console.log("DEVMODE:",e.data.close_prices)};e()},[t,n,o]),r)?(0,a.jsx)("div",{children:(0,a.jsx)(y,{data:r.close_prices})}):(0,a.jsx)("div",{children:"Loading..."})}function f(){let[e,t]=(0,s.useState)(["AMZN"]),[n,o]=(0,s.useState)([]),[c,i]=(0,s.useState)([]),[l,d]=(0,s.useState)(!0),[h,u]=(0,s.useState)("2022-01-01"),[x,j]=(0,s.useState)("2022-12-31"),[k,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)(null),[w,g]=(0,s.useState)({advancedView:!1}),[S,C]=(0,s.useState)(null),[D,_]=(0,s.useState)([]),E=()=>{alert("Error: stock cannot be an empty string")},A=e=>{t(t=>t.includes(e)?t:(F(t),i([]),[...t,e]))},F=e=>{o(t=>[...t,e])},O=()=>{o(t=>[...t,e]),i([]),t([])};async function V(e,t){let n=await N(e,0);return n}async function N(e,t){return await Promise.all(Object.entries(e).map(async e=>{let[n,a]=e,s=await fetch("http://localhost:5001/get_ratios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({returns:Object.values(a.daily_returns),risk_free_rate:t,beta:a.beta,max_drawdown:a.max_drawdown})});return{symbol:n,data:await s.json()}}))}async function P(){d(!0);let t=await R(e,h,x);C(t.stockData),v(t.extraStockData);let n=await V(t.extraStockData,t.stockData);_(n),d(!1)}async function R(e,t,n){let a=await M(e,t,n),s=await T(a),{stockDataResult:o,extraStockDataResult:r}=function(e,t){let n={},a={};return e.forEach((e,s)=>{n[e]=t[s].close_prices,a[e]={max_drawdown:t[s].max_drawdown,beta:t[s].beta,daily_returns:t[s].daily_returns}}),{stockDataResult:n,extraStockDataResult:a}}(e,s);return{stockData:o,extraStockData:r}}async function M(e,t,n){return await Promise.all(e.map(e=>fetch("http://localhost:8000/stock?symbol=".concat(e,"&start=").concat(t,"&end=").concat(n))))}async function T(e){return await Promise.all(e.map(e=>e.json()))}return(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:"Stock Portfolio Backtester"}),(0,a.jsx)("label",{htmlFor:"start-date",children:"Start Date:"}),(0,a.jsx)("input",{id:"start-date",type:"date",value:h,onChange:e=>u(e.target.value)}),(0,a.jsx)("label",{htmlFor:"end-date",children:"End Date:"}),(0,a.jsx)("input",{id:"end-date",type:"date",value:x,onChange:e=>j(e.target.value)}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r,{onAddStock:e=>{if(""===e){E();return}if("devmode on"==e){y(!0);return}if("devmode off"==e){y(!1);return}A(e=e.toUpperCase())},onRemoveStock:e=>{t(t=>t.includes(e)?(o(e=>[...e,t]),i([]),t.filter(t=>t!==e)):t)},onToggleAdvancedView:()=>{g(e=>({...e,advancedView:!e.advancedView}))},onFetchStockData:P,stockList:e}),(0,a.jsx)("button",{onClick:()=>{n.length>0&&(i(t=>[...t,e]),t(n[n.length-1]),o(e=>e.slice(0,-1)))},children:"Undo"}),(0,a.jsx)("button",{onClick:()=>{c.length>0&&(o(t=>[...t,e]),t(c[c.length-1]),i(e=>e.slice(0,-1)))},children:"Redo"}),(0,a.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to remove all stocks?")&&O()},children:"Remove All Stocks"})]}),!l&&S?(0,a.jsx)(p,{data:S}):(0,a.jsx)("p",{children:"Stock chart:"}),w.advancedView?(0,a.jsx)("p",{children:"Advanced View Statistics:"}):(0,a.jsx)(a.Fragment,{}),w.advancedView&&S&&f&&D?(0,a.jsx)(m,{data:S,extraStockData:f,stockRatios:D}):(0,a.jsx)(a.Fragment,{}),k?(0,a.jsx)("h1",{children:"DEVMODE ON"}):(0,a.jsx)(a.Fragment,{}),k&&e.length>0?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(b,{symbol:e[0],start:h,end:x})}):(0,a.jsx)(a.Fragment,{})]})})}}},function(e){e.O(0,[922,253,698,744],function(){return e(e.s=2005)}),_N_E=e.O()}]);